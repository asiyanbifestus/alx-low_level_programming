More automatic and dynamic allocation
